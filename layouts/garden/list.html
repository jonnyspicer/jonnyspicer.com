{{ define "main" }}
<div class="garden-page">
    <h1 class="big-title">Garden</h1>

    <div class="garden-intro">
        <p>This is my <a href="https://maggieappleton.com/garden-history" target="_blank" rel="noopener">digital garden</a> of projects â€” continuously evolving ideas in various states of growth. Some are stable and bloomed, some are still taking shape, and some are just seeds I'm nurturing.</p>

        <div class="growth-legend">
            <span class="legend-item"><span class="tier-badge tier-bloomed">ðŸŒ³ Bloomed</span> Stable and ready</span>
            <span class="legend-item"><span class="tier-badge tier-growing">ðŸŒ± Growing</span> Experimental</span>
            <span class="legend-item"><span class="tier-badge tier-seed">ðŸŒ° Seed</span> Early stages</span>
        </div>
    </div>

    {{/* Sort all garden items by last_tended date, most recent first */}}
    {{ $allProjects := .Pages }}
    {{ $sortedProjects := sort $allProjects ".Params.last_tended" "desc" }}

    <div class="garden-stream">
        {{ range $index, $project := $sortedProjects }}
            {{ $tier := $project.Params.tier }}

            {{/* Bloomed garden items get full treatment */}}
            {{ if eq $tier "shipped" }}
            <article class="garden-entry project-bloomed">
                <div class="garden-header">
                    <h2><a href="{{$project.RelPermalink}}">{{ $project.Title }}</a></h2>
                    <span class="tier-badge tier-bloomed">ðŸŒ³ Bloomed</span>
                </div>

                {{ if or $project.Params.tech_stack $project.Params.last_tended }}
                <div class="garden-meta">
                    {{ if $project.Params.tech_stack }}
                    <span class="meta-item">{{ $project.Params.tech_stack }}</span>
                    {{ end }}
                    {{ if $project.Params.last_tended }}
                    <span class="meta-item">Tended {{ $project.Params.last_tended }}</span>
                    {{ end }}
                </div>
                {{ end }}

                <div class="garden-content">
                    {{ $project.Content }}
                </div>

                {{ if or $project.Params.project_url $project.Params.github }}
                <div class="garden-actions">
                    {{ if $project.Params.project_url }}
                    <a href="{{ $project.Params.project_url }}" class="garden-link primary" target="_blank" rel="noopener">Try it â†’</a>
                    {{ end }}
                    {{ if $project.Params.github }}
                    <a href="{{ $project.Params.github }}" class="garden-link secondary" target="_blank" rel="noopener">GitHub</a>
                    {{ end }}
                </div>
                {{ end }}
            </article>

            {{/* Growing garden items get medium treatment */}}
            {{ else if eq $tier "growing" }}
            <article class="garden-entry project-growing">
                <div class="garden-header">
                    <h3><a href="{{$project.RelPermalink}}">{{ $project.Title }}</a></h3>
                    <span class="tier-badge tier-growing">ðŸŒ± Growing</span>
                </div>

                {{ if or $project.Params.tech_stack $project.Params.last_tended }}
                <div class="garden-meta">
                    {{ if $project.Params.tech_stack }}
                    <span class="meta-item">{{ $project.Params.tech_stack }}</span>
                    {{ end }}
                    {{ if $project.Params.last_tended }}
                    <span class="meta-item">Tended {{ $project.Params.last_tended }}</span>
                    {{ end }}
                </div>
                {{ end }}

                <div class="garden-summary">
                    {{ $project.Params.summary }}
                </div>

                {{ if or $project.Params.project_url $project.Params.github }}
                <div class="garden-actions">
                    {{ if $project.Params.project_url }}
                    <a href="{{ $project.Params.project_url }}" class="garden-link" target="_blank" rel="noopener">Try it â†’</a>
                    {{ end }}
                    {{ if $project.Params.github }}
                    <a href="{{ $project.Params.github }}" class="garden-link" target="_blank" rel="noopener">GitHub</a>
                    {{ end }}
                </div>
                {{ end }}
            </article>

            {{/* Seed garden items get minimal treatment */}}
            {{ else if eq $tier "seed" }}
            <article class="garden-entry project-seed">
                <div class="garden-header">
                    <h4>{{ $project.Title }}</h4>
                    <span class="tier-badge tier-seed">ðŸŒ° Seed</span>
                </div>

                {{ if $project.Params.tech_stack }}
                <div class="garden-meta">
                    <span class="meta-item">{{ $project.Params.tech_stack }}</span>
                </div>
                {{ end }}

                <div class="garden-summary">
                    {{ $project.Params.summary }}
                </div>
            </article>
            {{ end }}
        {{ end }}
    </div>

    <div class="garden-footer">
        <p>More experiments on <a href="https://github.com/jonnyspicer" target="_blank" rel="noopener">GitHub</a>. Questions or ideas? <a href="/contact">Say hi</a>.</p>
    </div>
</div>
{{ end }}
