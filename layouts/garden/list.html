{{ define "main" }}
<div class="garden-page">
    <div class="garden-narrow">
        <h1 class="big-title">Garden</h1>

        <div class="garden-intro">
            <p>This is my <a href="https://maggieappleton.com/garden-history" target="_blank" rel="noopener">digital garden</a> â€” continuously evolving ideas in various states of growth.</p>
        </div>

        {{/* Topic Filters */}}
        <div class="garden-filters">
            <button class="filter-btn active" data-topic="all">All</button>
            <button class="filter-btn" data-topic="web">Web</button>
            <button class="filter-btn" data-topic="ai">AI</button>
            <button class="filter-btn" data-topic="writing">Writing</button>
            <button class="filter-btn" data-topic="tools">Tools</button>
            <button class="filter-btn" data-topic="trading">Trading</button>
            <button class="filter-btn" data-topic="wellbeing">Wellbeing</button>
            <button class="filter-btn" data-topic="go">Go</button>
            <button class="filter-btn" data-topic="chess">Chess</button>
            <button class="filter-btn" data-topic="consulting">Consulting</button>
        </div>
    </div>

    {{/* Sort all garden items by last_tended date, most recent first */}}
    {{ $allProjects := .Pages }}
    {{ $sortedProjects := sort $allProjects ".Params.last_tended" "desc" }}

    <div class="garden-stream">
        {{ range $sortedProjects }}
        {{ $tier := .Params.tier }}
        {{ $tierClass := "project-seed" }}
        {{ if eq $tier "shipped" }}{{ $tierClass = "project-bloomed" }}{{ else if eq $tier "growing" }}{{ $tierClass = "project-growing" }}{{ end }}

        <article class="garden-entry {{ $tierClass }}" data-topics="{{ delimit .Params.topics " " }}">
            <a href="{{ .RelPermalink }}" class="garden-card-link">
                {{ if .Params.image }}<img class="garden-card-image" src="{{ .Params.image }}" alt="{{ .Title }}" loading="lazy">{{ end }}
                <div class="garden-card-body">
                    <div class="garden-card-top">
                        {{ if eq $tier "shipped" }}<span class="tier-badge tier-bloomed">ðŸŒ³ Bloomed</span>
                        {{ else if eq $tier "growing" }}<span class="tier-badge tier-growing">ðŸŒ± Growing</span>
                        {{ else }}<span class="tier-badge tier-seed">ðŸŒ° Seed</span>{{ end }}
                        {{ if .Params.last_tended }}<span class="garden-date">{{ .Params.last_tended }}</span>{{ end }}
                    </div>
                    <h3 class="garden-card-title">{{ .Title }}</h3>
                    {{ if .Params.summary }}<p class="garden-card-summary">{{ .Params.summary }}</p>{{ end }}
                </div>
            </a>
        </article>
        {{ end }}
    </div>

    <div class="garden-narrow">
        <div class="garden-footer">
            <p>More experiments on <a href="https://github.com/jonnyspicer" target="_blank" rel="noopener">GitHub</a>. Questions or ideas? <a href="/contact">Say hi</a>.</p>
        </div>
    </div>
</div>
{{ end }}
